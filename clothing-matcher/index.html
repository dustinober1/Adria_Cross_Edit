<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clothing Matcher - Adria Cross</title>
    <link rel="icon" href="/images/icon-152x152.png" type="image/png">
    <meta name="description"
        content="Upload your clothing items and get perfect outfit combinations with our AI-powered matching system.">
    <link rel="stylesheet" href="/css/landing.min.css">
    <link rel="stylesheet" href="/clothing-matcher/css/matcher.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/js/all.min.js" defer></script>
</head>

<body>
    <!-- Navigation -->
    <nav class="top-nav" role="navigation" aria-label="Main navigation">
        <div class="nav-container">
            <div class="nav-logo">
                <a href="/" class="has-logo">
                    <img src="/images/icon-144x144.webp" alt="Adria Cross Edit Logo" class="logo-image" width="50"
                        height="50">
                    <span class="logo-text">Adria Cross</span>
                </a>
            </div>
            <button class="nav-toggle" id="navToggle" aria-label="Toggle navigation menu" aria-expanded="false">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <ul class="nav-menu" id="navMenu">
                <li><a href="../index.html">Home</a></li>
                <li><a href="../about.html">About</a></li>
                <li><a href="../services.html">Services</a></li>
                <li><a href="../blog.html">Blog</a></li>
                <li><a href="index.html" class="active">Clothing Matcher</a></li>
                <li><a href="../contact.html">Contact</a></li>
                <li class="auth-user-display" style="display:none; color: var(--primary); font-weight: 600;"></li>
                <li><a href="/admin.html" class="auth-link" data-type="login">Login</a></li>
            </ul>
        </div>
    </nav>

    <main id="main-content" role="main">
        <div class="matcher-container">
            <!-- Initial Loading State -->
            <div id="initialLoading" style="text-align: center; padding: 3rem; display: block;">
                <div style="font-size: 2rem; margin-bottom: 1rem;">üëó</div>
                <p>Loading your clothing matcher...</p>
            </div>

            <!-- Header -->
            <div class="matcher-header">
                <h1 class="matcher-title">üëó Clothing Matcher</h1>
                <p class="matcher-subtitle">Upload your wardrobe and discover perfect outfit combinations</p>
            </div>

            <!-- Auth Promo Section - Shown to non-authenticated users -->
            <div class="auth-promo-section" id="authPromoSection" style="display: none;">
                <div class="promo-banner">
                    <div class="promo-icon">‚ú®</div>
                    <h2 class="promo-title">Unlock Unlimited Uploads</h2>
                    <p class="promo-text">
                        Create a <strong>FREE account</strong> to upload unlimited clothing items and save your wardrobe
                        permanently!
                    </p>
                    <div class="promo-features">
                        <div class="promo-feature">
                            <span class="feature-icon">üì∏</span>
                            <span>Unlimited uploads</span>
                        </div>
                        <div class="promo-feature">
                            <span class="feature-icon">üíæ</span>
                            <span>Save your wardrobe</span>
                        </div>
                        <div class="promo-feature">
                            <span class="feature-icon">üëó</span>
                            <span>Personalized matches</span>
                        </div>
                    </div>
                </div>

                <!-- Auth Tabs -->
                <div class="auth-tabs">
                    <button class="auth-tab active" data-auth-tab="login"
                        onclick="switchAuthTab('login')">Login</button>
                    <button class="auth-tab" data-auth-tab="register" onclick="switchAuthTab('register')">Create
                        Account</button>
                </div>

                <!-- Login Panel -->
                <div class="auth-panel" id="loginPanel">
                    <div class="social-auth-container">
                        <a href="/auth/google" class="btn-social btn-google">
                            <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg"
                                alt="Google Logo">
                            Sign in with Google
                        </a>
                    </div>
                    <div class="auth-divider">
                        <span>OR</span>
                    </div>
                    <form class="auth-form" id="loginForm">
                        <div class="form-group">
                            <input type="text" id="loginUsername" placeholder="Email or Username" class="form-input"
                                required>
                        </div>
                        <div class="form-group">
                            <input type="password" id="loginPassword" placeholder="Password" class="form-input"
                                required>
                        </div>
                        <button type="submit" class="btn btn-primary btn-full">Login</button>
                    </form>
                    <p class="auth-help">Don't have an account? <a href="#"
                            onclick="switchAuthTab('register'); return false;">Create one for free!</a></p>
                </div>

                <!-- Register Panel -->
                <div class="auth-panel" id="registerPanel" style="display: none;">
                    <div class="social-auth-container">
                        <a href="/auth/google" class="btn-social btn-google">
                            <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg"
                                alt="Google Logo">
                            Sign up with Google
                        </a>
                    </div>
                    <div class="auth-divider">
                        <span>OR</span>
                    </div>
                    <form class="auth-form" id="registerForm">
                        <div class="form-group">
                            <input type="text" id="regUsername" placeholder="Choose a username" class="form-input"
                                required minlength="3">
                        </div>
                        <div class="form-group">
                            <input type="email" id="regEmail" placeholder="Email address" class="form-input" required>
                        </div>
                        <div class="form-group">
                            <input type="text" id="regDisplayName" placeholder="Your name (optional)"
                                class="form-input">
                        </div>
                        <div class="form-group">
                            <input type="password" id="regPassword" placeholder="Password (min 6 characters)"
                                class="form-input" required minlength="6">
                        </div>
                        <button type="submit" class="btn btn-primary btn-full">Create Free Account</button>
                    </form>
                    <p class="auth-help">Already have an account? <a href="#"
                            onclick="switchAuthTab('login'); return false;">Login here</a></p>
                </div>
            </div>

            <!-- Upload Limit Warning - Shown when limit is reached -->
            <div class="limit-warning" id="limitWarning" style="display: none;">
                <div class="warning-content">
                    <span class="warning-icon">‚ö†Ô∏è</span>
                    <div class="warning-text">
                        <strong>You've reached the limit of 2 items per category.</strong>
                        <p>Create a free account to unlock unlimited uploads!</p>
                    </div>
                    <button class="btn btn-primary btn-sm" onclick="showAuthSection()">Create Free Account</button>
                </div>
            </div>

            <!-- Authenticated User Limits Display -->
            <div class="limits-display" id="limitsDisplay" style="display: none;">
                <h3 class="limits-title">üìä Your Upload Limits</h3>
                <div class="limits-grid">
                    <!-- Limits will be populated by JavaScript -->
                </div>
            </div>

            <!-- Navigation Tabs -->
            <div class="matcher-nav">
                <button class="nav-tab" data-view="upload" onclick="app.views.show('upload')">
                    üì§ Upload Items
                </button>
                <button class="nav-tab" data-view="wardrobe" onclick="app.views.show('wardrobe')">
                    üëî My Wardrobe
                </button>
                <button class="nav-tab" data-view="matcher" onclick="app.views.show('matcher')">
                    üíï Find Matches
                </button>
            </div>

            <!-- Upload View -->
            <div class="upload-view" id="uploadView" style="display: none;">
                <div class="upload-section">
                    <h2 style="text-align: center; margin-bottom: 2rem; color: var(--primary-color);">
                        üì∏ Upload Your Clothing
                    </h2>

                    <div class="upload-area" id="uploadArea">
                        <div class="upload-icon">üì§</div>
                        <p class="upload-text">Drag & drop images here or click to browse</p>
                        <p style="font-size: 0.9rem; color: var(--text-lighter);">Maximum file size: 5MB</p>
                        <input type="file" id="fileInput" accept="image/jpeg,image/jpg,image/png,image/webp"
                            style="display: none;">
                    </div>

                    <form class="upload-form" id="uploadForm">
                        <div class="form-group">
                            <label class="form-label">Category *</label>
                            <select class="form-select" id="categorySelect" required>
                                <option value="">Select category...</option>
                                <!-- Categories will be populated by JavaScript -->
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Brand (optional)</label>
                            <input type="text" class="form-input" id="brandInput" placeholder="e.g., Nike, Zara, H&M">
                        </div>

                        <div class="form-group">
                            <label class="form-label">Pattern *</label>
                            <select class="form-select" id="patternSelect" required>
                                <option value="">Select pattern...</option>
                                <option value="solid">Solid</option>
                                <option value="striped">Striped</option>
                                <option value="plaid">Plaid</option>
                                <option value="floral">Floral</option>
                                <option value="geometric">Geometric</option>
                                <option value="abstract">Abstract/Print</option>
                                <option value="textured">Textured</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Colors (comma-separated)</label>
                            <input type="text" class="form-input" id="colorsInput"
                                placeholder="e.g., blue, black, white">
                        </div>

                        <div class="form-group">
                            <label class="form-label">Style (comma-separated)</label>
                            <input type="text" class="form-input" id="stylesInput"
                                placeholder="e.g., casual, formal, business">
                        </div>

                        <div class="form-group">
                            <label class="form-label">Season (comma-separated)</label>
                            <input type="text" class="form-input" id="seasonsInput"
                                placeholder="e.g., spring, summer, fall, winter">
                        </div>

                        <button type="submit" class="btn btn-primary" id="uploadButton" disabled>
                            üì§ Upload Item
                        </button>
                    </form>
                </div>
            </div>

            <!-- Wardrobe View -->
            <div class="wardrobe-view" id="wardrobeView" style="display: none;">
                <div class="matcher-header">
                    <h2 class="matcher-title">üëî Your Wardrobe</h2>
                    <p class="matcher-subtitle">Manage your clothing collection</p>
                </div>

                <div class="wardrobe-grid" id="wardrobeGrid">
                    <!-- Wardrobe items will be populated by JavaScript -->
                </div>
            </div>

            <!-- Matcher View -->
            <div class="matcher-view" id="matcherView" style="display: none;">
                <div class="match-header">
                    <h2 class="match-title">üíï Find Your Perfect Match</h2>
                    <p class="match-subtitle">Swipe right to like, left to pass, or skip to see another option</p>
                </div>

                <div class="match-container" id="matchContainer">
                    <!-- Match card will be populated by JavaScript -->
                </div>

                <div class="match-controls" id="matchControls">
                    <button class="match-button skip" onclick="app.actions.handleMatch('skip')">
                        ‚è≠Ô∏è Skip
                    </button>
                    <button class="match-button dislike" onclick="app.actions.handleMatch('dislike')">
                        üëé Dislike
                    </button>
                    <button class="match-button like" onclick="app.actions.handleMatch('like')">
                        üíñ Like
                    </button>
                </div>

                <div class="match-score" id="matchScore">
                    <!-- Match score will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="site-footer" role="contentinfo">
        <div class="footer-container">
            <div class="footer-brand">
                <h3>Adria Cross</h3>
                <p>Personal Stylist helping you discover your perfect style through smart clothing matching.</p>
            </div>
            <nav class="footer-nav" aria-label="Footer navigation">
                <h4>Quick Links</h4>
                <ul>
                    <li><a href="/">Home</a></li>
                    <li><a href="/about.html">About Me</a></li>
                    <li><a href="/services.html">Services</a></li>
                    <li><a href="/blog.html">Style Blog</a></li>
                    <li><a href="/clothing-matcher/" class="active">Clothing Matcher</a></li>
                    <li><a href="/contact.html">Contact</a></li>
                    <li><a href="/admin.html">Admin</a></li>
                </ul>
            </nav>
            <div class="footer-contact">
                <h4>Get In Touch</h4>
                <p>üìß <a href="mailto:hello@adriacrossedit.com">hello@adriacrossedit.com</a></p>
                <p>üìç Available for in-person & virtual styling</p>
                <p>üìÖ <a href="/contact.html#calendar-section">Book a Free Consultation</a></p>
            </div>
            <div class="footer-social">
                <h4>Follow Along</h4>
                <div class="footer-social-links">
                    <a href="https://www.instagram.com/adriacrossedit/" target="_blank" aria-label="Instagram"
                        title="Follow on Instagram"><i class="fa-brands fa-instagram"></i></a>
                    <a href="https://www.facebook.com/adria.chittenden" target="_blank" aria-label="Facebook"
                        title="Follow on Facebook"><i class="fa-brands fa-facebook"></i></a>
                    <a href="https://x.com/AdriaCross1618" target="_blank" aria-label="X" title="Follow on X"><i
                            class="fa-brands fa-x-twitter"></i></a>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p class="footer-copyright">¬© 2025 Adria Cross. All rights reserved.</p>
            <div class="footer-legal">
                <a href="/privacy-policy.html">Privacy Policy</a>
                <a href="/terms-of-service.html">Terms of Service</a>
            </div>
        </div>
    </footer>

    <!-- Dark Mode Toggle -->
    <button class="dark-mode-toggle" id="darkModeToggle" aria-label="Toggle dark mode" title="Toggle dark/light mode">
        üåô
    </button>

    <script src="/js/main.min.js"></script>
    <script src="/clothing-matcher/js/matcher.js"></script>
    <script src="/js/auth.js"></script>
    <script>
        // Auth Tab Switching
        function switchAuthTab(tab) {
            const loginPanel = document.getElementById('loginPanel');
            const registerPanel = document.getElementById('registerPanel');
            const tabs = document.querySelectorAll('.auth-tab');

            tabs.forEach(t => t.classList.remove('active'));
            document.querySelector(`[data-auth-tab="${tab}"]`)?.classList.add('active');

            if (tab === 'login') {
                loginPanel.style.display = 'block';
                registerPanel.style.display = 'none';
            } else {
                loginPanel.style.display = 'none';
                registerPanel.style.display = 'block';
            }
        }

        // Show Auth Section
        function showAuthSection() {
            const authSection = document.getElementById('authPromoSection');
            if (authSection) {
                authSection.style.display = 'block';
                authSection.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        // Check Auth Status and Update UI
        async function checkMatcherAuth() {
            try {
                const response = await fetch('/api/auth/status');
                const data = await response.json();

                const authPromo = document.getElementById('authPromoSection');
                const limitsDisplay = document.getElementById('limitsDisplay');

                if (data.authenticated) {
                    // User is logged in - hide auth promo, show limits
                    if (authPromo) authPromo.style.display = 'none';
                    if (limitsDisplay) limitsDisplay.style.display = 'block';
                } else {
                    // User is not logged in - show auth promo
                    if (authPromo) authPromo.style.display = 'block';
                    if (limitsDisplay) limitsDisplay.style.display = 'none';
                }

                return data;
            } catch (error) {
                console.error('Auth check error:', error);
                return { authenticated: false };
            }
        }

        // Login Form Handler
        document.addEventListener('DOMContentLoaded', function () {
            const loginForm = document.getElementById('loginForm');
            const registerForm = document.getElementById('registerForm');

            if (loginForm) {
                loginForm.addEventListener('submit', async function (e) {
                    e.preventDefault();
                    const btn = this.querySelector('button[type="submit"]');
                    const originalText = btn.textContent;
                    btn.textContent = 'Logging in...';
                    btn.disabled = true;

                    try {
                        const response = await fetch('/api/login', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                username: document.getElementById('loginUsername').value,
                                password: document.getElementById('loginPassword').value
                            })
                        });

                        const data = await response.json();

                        if (response.ok && data.success) {
                            window.location.reload();
                        } else {
                            alert(data.error || 'Login failed. Please check your credentials.');
                        }
                    } catch (error) {
                        alert('Login failed. Please try again.');
                    } finally {
                        btn.textContent = originalText;
                        btn.disabled = false;
                    }
                });
            }

            if (registerForm) {
                registerForm.addEventListener('submit', async function (e) {
                    e.preventDefault();
                    const btn = this.querySelector('button[type="submit"]');
                    const originalText = btn.textContent;
                    btn.textContent = 'Creating account...';
                    btn.disabled = true;

                    try {
                        const response = await fetch('/api/register', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                username: document.getElementById('regUsername').value,
                                email: document.getElementById('regEmail').value,
                                displayName: document.getElementById('regDisplayName').value,
                                password: document.getElementById('regPassword').value
                            })
                        });

                        const data = await response.json();

                        if (response.ok && data.success) {
                            alert('Account created successfully! Welcome aboard! üéâ');
                            window.location.reload();
                        } else {
                            alert(data.error || 'Registration failed. Please try again.');
                        }
                    } catch (error) {
                        alert('Registration failed. Please try again.');
                    } finally {
                        btn.textContent = originalText;
                        btn.disabled = false;
                    }
                });
            }

            // Check auth status on load
            checkMatcherAuth();
        });
    </script>
</body>

</html>